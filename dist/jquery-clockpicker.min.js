/*!
 * Jquery JQClockPicker
 * Based on: http://weareoutman.github.io/clockpicker
 * Copyright 2016 Gustavo Real.
 * MIT Licence
 */
!function(){function t(t){return document.createElementNS(p,t)}function i(t){return(10>t?"0":"")+t}function e(t){var i=++q+"";return t?t+i:i}function s(t){return t>11?"PM":"AM"}function c(){}function o(s,c){function o(t,i){var e=p.offset(),s=/^touch/.test(t.type),o=e.left+g,a=e.top+g,l=(s?t.originalEvent.touches[0]:t).pageX-o,k=(s?t.originalEvent.touches[0]:t).pageY-a,d=Math.sqrt(l*l+k*k),f=!1;if(!i||!(w-A>d||d>w+A)){t.preventDefault();var b=setTimeout(function(){r.addClass("jqclockpicker-moving")},200);u&&p.append(T.canvas),T.setHand(l,k,!i,!0),h.off(m).on(m,function(t){t.preventDefault();var i=/^touch/.test(t.type),e=(i?t.originalEvent.touches[0]:t).pageX-o,s=(i?t.originalEvent.touches[0]:t).pageY-a;(f||e!==l||s!==k)&&(f=!0,T.setHand(e,s,!1,!0))}),h.off(v).on(v,function(t){h.off(v),t.preventDefault();var e=!1,s=!1;"hours"===T.currentView?(n(T.options.beforeHourSelect),e=!0):(n(T.options.beforeMinuteSelect),s=!0);var u=/^touch/.test(t.type),d=(u?t.originalEvent.changedTouches[0]:t).pageX-o,j=(u?t.originalEvent.changedTouches[0]:t).pageY-a;(i||f)&&d===l&&j===k&&T.setHand(d,j),"hours"===T.currentView?T.toggleView("minutes",C/2):c.autoClose&&(T.minutesView.addClass("jqclockpicker-dial-out"),setTimeout(function(){T.done()},C/2)),p.prepend(I),clearTimeout(b),r.removeClass("jqclockpicker-moving"),h.off(m),e&&n(T.options.afterHourSelect),s&&n(T.options.afterMinuteSelect)})}}var l=a(c.template),p=l.find(".jqclockpicker-plate"),k=l.find(".jqclockpicker-hours"),d=l.find(".jqclockpicker-minutes"),b=l.find(".jqclockpicker-am-pm-block"),j="INPUT"===s.prop("tagName"),q=j?s:s.find("input"),T=this;if(this.id=e("jqcp"),this.element=s,this.options=c,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=j,this.input=q,this.template=l,this.plate=p,this.hoursView=k,this.minutesView=d,this.amPmBlock=b,this.hoursLabel=l.find(".jqclockpicker-hours-label"),this.minutesLabel=l.find(".jqclockpicker-minutes-label"),this.spanAmPm=l.find(".jqclockpicker-span-am-pm"),this.amOrPm="PM",this.lastVal,"12h"===c.format){var P=['<div class="jqclockpicker-am-button jqclockpicker-clickable">AM</div>','<div class="jqclockpicker-pm-button jqclockpicker-clickable">PM</div>'].join(""),S=a(P);this.amPmBlock.on("click",".jqclockpicker-am-button",function(){T.amOrPm="AM",T.amPmBlock.find(".jqclockpicker-am-button").addClass("jqclockpicker-active"),T.amPmBlock.find(".jqclockpicker-pm-button").removeClass("jqclockpicker-active")}),this.amPmBlock.on("click",".jqclockpicker-pm-button",function(){T.amOrPm="PM",T.amPmBlock.find(".jqclockpicker-pm-button").addClass("jqclockpicker-active"),T.amPmBlock.find(".jqclockpicker-am-button").removeClass("jqclockpicker-active")}),S.appendTo(this.amPmBlock)}if(!c.autoClose){if(c.appendActions){var V=['<div class="jqclockpicker-footer">','<div class="jqclockpicker-actions">','<button type="button" class="jqclockpicker-cancel-button jqclockpicker-button jqclockpicker-clickable">'+c.cancelText+"</button>",'<button type="button" class="jqclockpicker-ok-button jqclockpicker-button jqclockpicker-clickable">'+c.okText+"</button>","</div>","</div>"].join("");a(V).appendTo(l)}l.on("click",".jqclockpicker-ok-button",a.proxy(this.done,this)),l.on("click",".jqclockpicker-cancel-button",a.proxy(this.hide,this))}l.addClass("jqclockpicker-position-"+c.position),l.addClass("jqclockpicker-align-"+c.alignment),this.hoursLabel.click(a.proxy(this.toggleView,this,"hours")),this.minutesLabel.click(a.proxy(this.toggleView,this,"minutes")),q.on("focus.jqclockpicker click.jqclockpicker",a.proxy(this.show,this)),q.on("keyup",a.proxy(this._doKeyUp,this));var H,x,L,B,D=a('<div class="jqclockpicker-tick"></div>');if("12h"===c.format)for(H=1;13>H;H+=1)x=D.clone(),L=H/6*Math.PI,B=w,x.css("font-size","115%"),x.css({left:g+Math.sin(L)*B-A,top:g-Math.cos(L)*B-A}),x.html(0===H?"00":H),k.append(x),x.on(f,o);else for(H=0;24>H;H+=1){x=D.clone(),L=H/6*Math.PI;var E=H>0&&13>H;B=E?M:w,x.css({left:g+Math.sin(L)*B-A,top:g-Math.cos(L)*B-A}),E&&x.css("font-size","115%"),x.html(0===H?"00":H),k.append(x),x.on(f,o)}for(H=0;60>H;H+=5)x=D.clone(),L=H/30*Math.PI,x.css({left:g+Math.sin(L)*w-A,top:g-Math.cos(L)*w-A}),x.css("font-size","115%"),x.html(i(H)),d.append(x),x.on(f,o);if(p.on(f,function(t){0===a(t.target).closest(".jqclockpicker-tick").length&&o(t,!0)}),u){var I=l.find(".jqclockpicker-canvas"),O=t("svg");O.setAttribute("class","jqclockpicker-svg"),O.setAttribute("width",y),O.setAttribute("height",y);var _=t("g");_.setAttribute("transform","translate("+g+","+g+")");var U=t("circle");U.setAttribute("class","jqclockpicker-canvas-bearing"),U.setAttribute("cx",0),U.setAttribute("cy",0),U.setAttribute("r",2);var z=t("line");z.setAttribute("x1",0),z.setAttribute("y1",0);var N=t("circle");N.setAttribute("class","jqclockpicker-canvas-bg"),N.setAttribute("r",A);var F=t("circle");F.setAttribute("class","jqclockpicker-canvas-fg"),F.setAttribute("r",3.5),_.appendChild(z),_.appendChild(F),_.appendChild(N),_.appendChild(U),O.appendChild(_),I.append(O),this.hand=z,this.bg=N,this.fg=F,this.bearing=U,this.g=_,this.canvas=I}n(this.options.init)}function n(t){t&&"function"==typeof t&&t()}var r,a=window.jQuery,l=a(window),h=a(document),p="http://www.w3.org/2000/svg",u="SVGAngle"in window&&function(){var t,i=document.createElement("div");return i.innerHTML="<svg/>",t=(i.firstChild&&i.firstChild.namespaceURI)==p,i.innerHTML="",t}(),k=function(){var t=document.createElement("div").style;return"transition"in t||"WebkitTransition"in t||"MozTransition"in t||"msTransition"in t||"OTransition"in t}(),d="ontouchstart"in window,f="mousedown"+(d?" touchstart":""),m="mousemove.jqclockpicker"+(d?" touchmove.jqclockpicker":""),v="mouseup.jqclockpicker"+(d?" touchend.jqclockpicker":""),b=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,j=['<div class="jqclockpicker-container">','<div class="jqclockpicker-header">','<div class="jqclockpicker-time">','<span class="jqclockpicker-hours-label jqclockpicker-clickable"></span>','<span class="jqclockpicker-label-separator">:</span>','<span class="jqclockpicker-minutes-label jqclockpicker-clickable"></span>',"</div>",'<div class="jqclockpicker-am-pm-block"></div>',"</div>",'<div class="jqclockpicker-body">','<div class="jqclockpicker-plate">','<div class="jqclockpicker-canvas"></div>','<div class="jqclockpicker-dial jqclockpicker-hours"></div>','<div class="jqclockpicker-dial jqclockpicker-minutes jqclockpicker-dial-out"></div>',"</div>","</div>","</div>"].join("");o.DEFAULTS={autoClose:!0,appendActions:!0,format:"24h",okText:"OK",cancelText:"Cancel",defaultTime:"",timeFromNow:0,vibrate:!0,position:"bottom",alignment:"left",template:j,beforeShow:c,afterShow:c,beforeHide:c,afterHide:c,beforeShowHours:c,afterShowHours:c,beforeShowMinutes:c,afterShowMinutes:c,beforeHourSelect:c,afterHourSelect:c,beforeMinuteSelect:c,afterMinuteSelect:c,beforeDone:c,afterDone:c};var q=0,g=100,w=83,M=60,A=13,y=2*g,C=k?350:1;a.extend(o.prototype,{toggle:function(){this[this.isShown?"hide":"show"]()},locate:function(){var t=this.element,i=this.template,e=t.offset(),s=t.outerWidth(),c=t.outerHeight(),o=this.options.position,n=this.options.alignment,r={};switch(i.show(),o){case"bottom":r.top=e.top+c;break;case"right":r.left=e.left+s;break;case"top":r.top=e.top-i.outerHeight();break;case"left":r.left=e.left-i.outerWidth()}switch(n){case"left":r.left=e.left;break;case"right":r.left=e.left+s-i.outerWidth()}i.css(r)},show:function(t){if(!this.isShown){n(this.options.beforeShow);var i=this;this.isAppended||(r=a(document.body).append(this.template),l.on("resize.jqclockpicker"+this.id,function(){i.isShown&&i.locate()}),this.isAppended=!0);var e=((this.input.prop("value")||this.options.defaultTime||"")+"").replace(/^\s\s*/,"").replace(/\s\s*$/,"");if("now"===e){var c=new Date(+new Date+this.options.timeFromNow);this.hours=c.getHours(),this.minutes=c.getMinutes(),this.amOrPm=s(this.hours)}else this._parseTime(e);this._updateLabels(),this.toggleView("hours"),this.locate(),this.isShown=!0,h.on("click.jqclockpicker."+this.id+" focusin.jqclockpicker."+this.id,function(t){var e=a(t.target);0===e.closest(i.template).length&&0===e.closest(i.input).length&&i.hide()}),h.on("keyup.jqclockpicker."+this.id,function(t){27===t.keyCode&&i.hide()}),n(this.options.afterShow)}},hide:function(){n(this.options.beforeHide),this.isShown=!1,h.off("click.jqclockpicker."+this.id+" focusin.jqclockpicker."+this.id),h.off("keyup.jqclockpicker."+this.id),this.template.hide(),n(this.options.afterHide)},toggleView:function(t,i){var e=!1,s=!1;"hours"===t&&(n(this.options.beforeShowHours),e=!0),"minutes"===t&&(n(this.options.beforeShowMinutes),s=!0);var c="hours"===t,o=c?this.hoursView:this.minutesView,r=c?this.minutesView:this.hoursView;this.currentView=t,this.hoursLabel.toggleClass("jqclockpicker-active",c),this.minutesLabel.toggleClass("jqclockpicker-active",!c),r.addClass("jqclockpicker-dial-out"),o.css("visibility","visible").removeClass("jqclockpicker-dial-out"),this.resetClock(i),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout(function(){r.css("visibility","hidden")},C),e&&n(this.options.afterShowHours),s&&n(this.options.afterShowMinutes)},resetClock:function(t){var i=this.currentView,e=this[i],s="hours"===i,c=Math.PI/(s?6:30),o=e*c,n=s&&e>0&&13>e?M:w,r=Math.sin(o)*n,a=-Math.cos(o)*n,l=this;u&&t?(l.canvas.addClass("jqclockpicker-canvas-out"),setTimeout(function(){l.canvas.removeClass("jqclockpicker-canvas-out"),l.setHand(r,a)},t)):this.setHand(r,a)},setHand:function(t,e,s,c){var o,n=Math.atan2(t,-e),r="hours"===this.currentView,l=Math.PI/(r||s?6:30),h=Math.sqrt(t*t+e*e),p=this.options,k=r&&(w+M)/2>h,d=k?M:w;if("12h"===p.format&&(d=w),0>n&&(n=2*Math.PI+n),o=Math.round(n/l),n=o*l,"12h"===p.format?r?0===o&&(o=12):(s&&(o*=5),60===o&&(o=0)):r?(12===o&&(o=0),o=k?0===o?12:o:0===o?0:o+12):(s&&(o*=5),60===o&&(o=0)),this[this.currentView]!==o&&b&&this.options.vibrate&&(this.vibrateTimer||(navigator[b](10),this.vibrateTimer=setTimeout(a.proxy(function(){this.vibrateTimer=null},this),100))),this[this.currentView]=o,this[r?"hoursLabel":"minutesLabel"].html(i(o)),this[r?"hoursView":"minutesView"].find(".jqclockpicker-tick").each(function(){var t=a(this);t.toggleClass("jqclockpicker-tick-active",o===+t.html())}),u){var f=Math.sin(n)*d,m=-Math.cos(n)*d,v=Math.sin(n)*(d-this.bg.getAttribute("r")),j=-Math.cos(n)*(d-this.bg.getAttribute("r"));this.hand.setAttribute("x2",v),this.hand.setAttribute("y2",j),this.bg.setAttribute("cx",f),this.bg.setAttribute("cy",m),this.fg.setAttribute("visibility","hidden"),this.bg.setAttribute("class","jqclockpicker-canvas-bg"),!r&&o%5&&(this.fg.setAttribute("cx",f),this.fg.setAttribute("cy",m),this.fg.setAttribute("visibility","visible")),c?this.g.insertBefore(this.hand,this.bearing):this.g.insertBefore(this.hand,this.bg)}},done:function(){n(this.options.beforeDone),this.hide();var t=this.input.prop("value"),e=i(this.hours)+":"+i(this.minutes);"12h"===this.options.format&&(e+=this.amOrPm),this.input.prop("value",e),this.lastVal=this.input.prop("value"),e!==t&&(this.input.trigger("change"),this.input.triggerHandler("change"),this.isInput||this.element.trigger("change")),this.options.autoClose&&this.input.trigger("blur"),n(this.options.afterDone)},remove:function(){this.element.removeData("jqclockpicker"),this.input.off("focus.jqclockpicker click.jqclockpicker").off("keyup",this._doKeyUp),this.isShown&&this.hide(),this.isAppended&&(l.off("resize.jqclockpicker"+this.id),this.template.remove())},_updateLabels:function(){this.hoursLabel.html(i(this.hours)),this.minutesLabel.html(i(this.minutes)),"12h"===this.options.format&&("AM"===this.amOrPm?(this.amPmBlock.find(".jqclockpicker-am-button").addClass("jqclockpicker-active"),this.amPmBlock.find(".jqclockpicker-pm-button").removeClass("jqclockpicker-active")):(this.amPmBlock.find(".jqclockpicker-pm-button").addClass("jqclockpicker-active"),this.amPmBlock.find(".jqclockpicker-am-button").removeClass("jqclockpicker-active")))},_parseTime:function(t){var i=t.replace(/^\s\s*/,"").replace(/\s\s*$/,"").toUpperCase(),e=i.match(/^([0-9]|0[0-9]|1[0-9]|2[0-3])(?::)?(?:(?::)([0-5][0-9])\s*(AM|PM)?)?$/);e?(this.hours=e[1]?+e[1]:0,this.minutes=e[2]?+e[2]:0,this.amOrPm=e[3]||null):(this.hours=0,this.minutes=0),this._updateLabels(),this.resetClock()},_doKeyUp:function(t){return this.input.val()!==this.lastVal&&this._parseTime(this.input.val()),!0}}),a.fn.jqclockpicker=function(t){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=a(this),s=e.data("jqclockpicker");if(s)"function"==typeof s[t]&&s[t].apply(s,i);else{var c=a.extend({},o.DEFAULTS,e.data(),"object"==typeof t&&t);e.data("jqclockpicker",new o(e,c))}})}}();